#!python
import sys
import jupyter_aws as jaws
from generic_templates import fill_template, Arglist
import os
import sys
import sys

def usage(appname:str):
    """- Shows usage information for fill-template.py"""
    print(f"Usage: {appname} [-D <VARNAME>[=<value>]] <templatefile> [template-argument...]")
    sys.exit(1)

def main(args : Arglist):
    _app = args.program
    env = {}
    args.stack_opts("D:")
    for opt in args.opt('D', []):
        if '=' in opt:
            name,value = opt.split("=")
            env[name] = value
        else:
            env[opt] = True
    template_file = args.shift()
    if not template_file or not os.path.isfile(template_file):
        usage(_app)

    # process the template
    fill_template(template_file, env, args.args)

if __name__ == "__main__":
    main(Arglist())